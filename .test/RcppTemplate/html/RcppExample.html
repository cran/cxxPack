<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Rcpp R/C++ interface example</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css"href="../../R.css">
</head><body>

<table width="100%" summary="page for RcppExample {RcppTemplate}"><tr><td>RcppExample {RcppTemplate}</td><td align="right">R Documentation</td></tr></table>

<h2>Rcpp R/C++ interface example</h2>


<h3>Description</h3>

<p>
<code>RcppExample</code> illustrates how the <code>Rcpp</code> R/C++
interface class library is used.
</p>


<h3>Usage</h3>

<pre>
RcppExample(params, nlist, numvec, nummat, df, datevec,
datetimevec, stringvec, func, hypot, zoots=NULL, myfactor=NULL)
## S3 method for class 'RcppExample':
print(x,...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>params</code></td>
<td>
A heterogeneous list of name-value pairs where the
values can be of different types (double, int, Date, etc.). The
names used will be referred to explicitly on the C++ side and an
exception is thrown if a name is not found.</td></tr>
<tr valign="top"><td><code>nlist</code></td>
<td>
a list of named numeric values (double or int). Use of
this is deprecated and support for this may be discontinued in the
future (use params instead).</td></tr>
<tr valign="top"><td><code>numvec</code></td>
<td>
a numeric 1D vector (double or int).</td></tr>
<tr valign="top"><td><code>nummat</code></td>
<td>
a numeric 2D matrix (double or int).</td></tr>
<tr valign="top"><td><code>df</code></td>
<td>
a data frame.</td></tr>
<tr valign="top"><td><code>zoots</code></td>
<td>
a zoo time series object.</td></tr>
<tr valign="top"><td><code>myfactor</code></td>
<td>
an R factor</td></tr>
<tr valign="top"><td><code>datevec</code></td>
<td>
a vector of Date's.</td></tr>
<tr valign="top"><td><code>datetimevec</code></td>
<td>
a vector of POSIXt dates.</td></tr>
<tr valign="top"><td><code>stringvec</code></td>
<td>
a vector of strings.</td></tr>
<tr valign="top"><td><code>func</code></td>
<td>
an R function that takes complex params and returns a vector</td></tr>
<tr valign="top"><td><code>hypot</code></td>
<td>
a function that computes the distance to the origin</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
Object of type <code>RcppExample</code>.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Extra named parameters.</td></tr>
</table>


<h3>Details</h3>

<p>
</p>
<p>
The source files for this
example and for the <code>Rcpp</code> class library
can be found in the RcppTemplate package source archive (the .tar.gz file).
</p>


<h3>Value</h3>

<p>
<code>RcppExample</code> returns a list containing name-value pairs where
the values are the R objects corresponding to selected C++ objects.
The original input parameter params is also returned.
</p>


<h3>Author(s)</h3>

<p>Dominick Samperi</p>


<h3>References</h3>

<p>
Samperi, D., (2009) <EM>Rcpp: A Class Library for R/C++
Object Mapping and R Package Development</EM>. Located in the
package <code>doc</code> subdirectory. Can be displayed using the
<code>showRcppDoc()</code> command.
</p>
<p>
Samperi, D., (2009) <EM>Rcpp Quick Reference</EM>, located
in the package <code>doc</code> subdirectory. Can be displayed using the
<code>showRcppQuickRef()</code> command.
</p>
<p>
<EM>Writing R Extensions</EM>, available at <a href="http:www.r-project.org">http:www.r-project.org</a>.
</p>


<h3>Examples</h3>

<pre>

Sys.getenv("R_PLATFORM")

currentTime &lt;- Sys.time() # POSIXt type (date and time)
startDate &lt;- as.Date('2009-10-01')
endDate &lt;- as.Date('2011-05-01')

params &lt;- list(method='BFGS',
               tolerance=1.0e-8,
               maxIter=1000,
               currentTime=currentTime,
               startDate=startDate,
               endDate=endDate,
               weekday=5, # Friday (Sun=0, Mon=1, etc.)
               nthOccurrence=3)

nlist &lt;- list(ibm = 80.50, hp = 53.64, c = 45.41)

numvec &lt;- as.double(seq(1,5)) # numerical vector

nummat &lt;- matrix(as.double(seq(1,20)),4,5) # numerical matrix

stringvec &lt;- c("hello", "world", "fractal") # string vector

datetimevec &lt;- currentTime + (1:3)*60*60*24 # 1-day increments

datevec &lt;- as.Date(currentTime) + 1:3 # drop fractional day part, scale rep.

myfactor &lt;- as.factor(c('good','bad','bad','good','good','great'))

# Tell R not to consider boy/dog/cat a factor here
df &lt;- data.frame(factr=c('beta','beta','gamma'),
                 words=I(c('boy','dog','cat')),
                 nums=c(1.1,3.14,5.6),
                 bools=c(TRUE,TRUE, FALSE),
                 dates=datevec,
                 times=datetimevec)

# Create zoo time series object indexed by irregular dates.
zoots &lt;- zoo(matrix(1:12,3,4), as.Date('2009-10-01') + c(1,5,2))

# Define R function to be called from C++.
func &lt;- function(df.dat, ts.dat, x) {
  if(class(df.dat) == "data.frame") {
    cat('func got valid data frame\n')
  }
  else {
    stop('func got invalid data frame\n')
  }
  if(length(class(ts.dat)) == 2 &amp;&amp; class(ts.dat) == "zooreg") {
    cat('func got valid regular zoo time series\n')
  }
  else {
    if(class(ts.dat) == "zoo") {
      cat('func got valid irregular zoo time series\n')
    }
    else {
      stop('func got invalid zoo time series\n')
    }
  }
  as.double(x^2)
}

hypot &lt;- function(a, b) {
  sqrt(a^2 + b^2)
}

fnvec &lt;- function(x) { sum(x) } # Add up components of vector
fnlist &lt;- function(l) { # Return vector with 1 added to each component
  vec &lt;- c(l$alpha + 1, l$beta + 1, l$gamma + 1)
  vec
}

result &lt;- RcppExample(params, nlist, numvec, nummat, df, datevec,
                      datetimevec, stringvec, func, hypot,
                      zoots, myfactor)                       
result

</pre>

<hr><div align="center">[Package <em>RcppTemplate</em> version 6.0 <a href="00Index.html">Index</a>]</div>
</body></html>
